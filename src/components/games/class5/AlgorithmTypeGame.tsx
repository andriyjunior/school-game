import { useEffect } from 'react';
import {
  GameProps,
  GameLayout,
  OptionGrid,
  QuestionDisplay,
  FeedbackSection,
  useGameState,
  useChallengeManager,
  OptionChallenge
} from '../../../engine';

interface AlgorithmTypeChallenge extends OptionChallenge {
  algorithmExample: string;
  algorithmType: 'linear' | 'branching' | 'cyclic';
  icon: string;
}

const ALGORITHM_TYPE_LIBRARY: AlgorithmTypeChallenge[] = [
  // Linear algorithms
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –ü—Ä–æ–∫–∏–Ω—É—Ç–∏—Å—è\n2. –£–º–∏—Ç–∏—Å—è\n3. –ü–æ—Å–Ω—ñ–¥–∞—Ç–∏\n4. –ü—ñ—Ç–∏ –≤ —à–∫–æ–ª—É",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–¶–µ –õ–Ü–ù–Ü–ô–ù–ò–ô –∞–ª–≥–æ—Ä–∏—Ç–º - –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ, –æ–¥–∏–Ω –∑–∞ –æ–¥–Ω–∏–º, –±–µ–∑ –≤–∏–±–æ—Ä—É –∞–±–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å.",
    algorithmType: 'linear',
    icon: "üîÑ"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É:",
    algorithmExample: "1. –í–∑—è—Ç–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏\n2. –ó–º—ñ—à–∞—Ç–∏ –±–æ—Ä–æ—à–Ω–æ –∑ –≤–æ–¥–æ—é\n3. –î–æ–¥–∞—Ç–∏ —Å—ñ–ª—å\n4. –ó–∞–º—ñ—Å–∏—Ç–∏ —Ç—ñ—Å—Ç–æ\n5. –í–∏–ø—ñ–∫–∞—Ç–∏ 30 —Ö–≤–∏–ª–∏–Ω",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ó–º—ñ—à–∞–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–õ–Ü–ù–Ü–ô–ù–ò–ô –∞–ª–≥–æ—Ä–∏—Ç–º - —Ä–µ—Ü–µ–ø—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º —É —á—ñ—Ç–∫—ñ–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ.",
    algorithmType: 'linear',
    icon: "ü•ñ"
  },
  {
    question: "–Ø–∫–∏–π —Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º?",
    algorithmExample: "1. –í–≤—ñ–º–∫–Ω—É—Ç–∏ –∫–æ–º–ø'—é—Ç–µ—Ä\n2. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É\n3. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ñ–∞–π–ª\n4. –ó–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª\n5. –ó–∞–∫—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–°–∫–ª–∞–¥–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–õ–Ü–ù–Ü–ô–ù–ò–ô - –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –¥—ñ–π –±–µ–∑ —É–º–æ–≤ —ñ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å. –ö–æ–∂–µ–Ω –∫—Ä–æ–∫ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ä—ñ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑.",
    algorithmType: 'linear',
    icon: "üíª"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø:",
    algorithmExample: "1. –ü—Ä–∏–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω\n2. –í–∑—è—Ç–∏ –∫–æ—à–∏–∫\n3. –ü–æ–∫–ª–∞—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∏\n4. –ü—ñ—Ç–∏ –Ω–∞ –∫–∞—Å—É\n5. –ó–∞–ø–ª–∞—Ç–∏—Ç–∏",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–†–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–õ–Ü–ù–Ü–ô–ù–ò–ô –∞–ª–≥–æ—Ä–∏—Ç–º - –ø–æ–∫—É–ø–∫–∏ —Ä–æ–±–ª—è—Ç—å—Å—è –∑–∞ —á—ñ—Ç–∫–æ—é –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—é –±–µ–∑ —É–º–æ–≤.",
    algorithmType: 'linear',
    icon: "üõí"
  },
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –î—ñ—Å—Ç–∞—Ç–∏ –∑–æ—à–∏—Ç\n2. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É\n3. –í–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è\n4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É\n5. –ó–∞–∫—Ä–∏—Ç–∏ –∑–æ—à–∏—Ç",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–õ–Ü–ù–Ü–ô–ù–ò–ô - –¥–æ–º–∞—à–Ω—è —Ä–æ–±–æ—Ç–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ, –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º.",
    algorithmType: 'linear',
    icon: "üìö"
  },

  // Branching algorithms
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è –Ω–∞ –≤—É–ª–∏—Ü—é\n2. –Ø–ö–©–û –π–¥–µ –¥–æ—â - –≤–∑—è—Ç–∏ –ø–∞—Ä–∞—Å–æ–ª—å–∫—É\n3. –Ü–ù–ê–ö–®–ï - –Ω–µ –±—Ä–∞—Ç–∏ –ø–∞—Ä–∞—Å–æ–ª—å–∫—É\n4. –í–∏–π—Ç–∏ –∑ –¥–æ–º—É",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–π"],
    correctAnswer: 1,
    explanation: "–¶–µ –†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô –∞–ª–≥–æ—Ä–∏—Ç–º - —î —É–º–æ–≤–∞ (–Ø–ö–©–û-–Ü–ù–ê–ö–®–ï), —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, —è–∫–∏–π –∫—Ä–æ–∫ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏.",
    algorithmType: 'branching',
    icon: "üåßÔ∏è"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø:",
    algorithmExample: "1. –í–∏—Ä—ñ—à–∏—Ç–∏ –∑–∞–¥–∞—á—É\n2. –Ø–ö–©–û –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø—Ä–∞–≤–∏–ª—å–Ω–∞ - –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ +\n3. –Ü–ù–ê–ö–®–ï - –≤–∏—Ä—ñ—à–∏—Ç–∏ —â–µ —Ä–∞–∑",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü—Ä–æ—Å—Ç–∏–π"],
    correctAnswer: 1,
    explanation: "–†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô - –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–±–∏—Ç—å –≤–∏–±—ñ—Ä –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —É–º–æ–≤–∏ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —á–∏ –Ω—ñ).",
    algorithmType: 'branching',
    icon: "‚úèÔ∏è"
  },
  {
    question: "–Ø–∫–∏–π —Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º?",
    algorithmExample: "1. –ü—ñ–¥—ñ–π—Ç–∏ –¥–æ —Å–≤—ñ—Ç–ª–æ—Ñ–æ—Ä–∞\n2. –Ø–ö–©–û –≥–æ—Ä–∏—Ç—å –∑–µ–ª–µ–Ω–∏–π - –ø–µ—Ä–µ–π—Ç–∏ –¥–æ—Ä–æ–≥—É\n3. –Ü–ù–ê–ö–®–ï - –∑–∞—á–µ–∫–∞—Ç–∏\n4. –Ü—Ç–∏ –¥–∞–ª—ñ",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ë–∞–∑–æ–≤–∏–π"],
    correctAnswer: 1,
    explanation: "–†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô - –¥—ñ—ó –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —É–º–æ–≤–∏ (–∫–æ–ª—ñ—Ä —Å–≤—ñ—Ç–ª–æ—Ñ–æ—Ä–∞). –¶–µ —É–º–æ–≤–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º.",
    algorithmType: 'branching',
    icon: "üö¶"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É:",
    algorithmExample: "1. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É\n2. –Ø–ö–©–û —Ö–æ–ª–æ–¥–Ω–æ - –æ–¥—è–≥—Ç–∏ –∫—É—Ä—Ç–∫—É\n3. –Ø–ö–©–û —Ç–µ–ø–ª–æ - –æ–¥—è–≥—Ç–∏ –ª–µ–≥–∫—É –∫–æ—Ñ—Ç—É\n4. –í–∏–π—Ç–∏",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ó–≤–∏—á–∞–π–Ω–∏–π"],
    correctAnswer: 1,
    explanation: "–†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô - –≤–∏–±—ñ—Ä –æ–¥—è–≥—É –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏. –ö—ñ–ª—å–∫–∞ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ä–æ–∑–≥–∞–ª—É–∂–µ–Ω–Ω—è.",
    algorithmType: 'branching',
    icon: "üß•"
  },
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø?",
    algorithmExample: "1. –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ —á–∏—Å–ª–æ\n2. –Ø–ö–©–û —á–∏—Å–ª–æ > 10 - –≤–∏–≤–µ—Å—Ç–∏ '–í–µ–ª–∏–∫–µ'\n3. –Ü–ù–ê–ö–®–ï - –≤–∏–≤–µ—Å—Ç–∏ '–ú–∞–ª–µ–Ω—å–∫–µ'",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π"],
    correctAnswer: 1,
    explanation: "–†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô - —É–º–æ–≤–∞ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤–∏–∑–Ω–∞—á–∞—î, —è–∫–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∏–≤–µ—Å—Ç–∏.",
    algorithmType: 'branching',
    icon: "üî¢"
  },

  // Cyclic algorithms
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –ü–û–ö–ò —î –≤–æ–¥–∞ –≤ —á–∞–π–Ω–∏–∫—É:\n   - –ù–∞–ª–∏—Ç–∏ –≤–æ–¥—É –≤ —á–∞—à–∫—É\n   - –ü–æ—Å—Ç–∞–≤–∏—Ç–∏ —á–∞—à–∫—É\n2. –ó–∞–∫—ñ–Ω—á–∏—Ç–∏",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü—Ä–æ—Å—Ç–∏–π"],
    correctAnswer: 2,
    explanation: "–¶–µ –¶–ò–ö–õ–Ü–ß–ù–ò–ô –∞–ª–≥–æ—Ä–∏—Ç–º - –¥—ñ—è –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è –ü–û–ö–ò –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —É–º–æ–≤–∞ (—î –≤–æ–¥–∞).",
    algorithmType: 'cyclic',
    icon: "‚òï"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø:",
    algorithmExample: "1. –ü–û–ö–ò –Ω–µ –¥–æ—á–∏—Ç–∞—é —Å—Ç–æ—Ä—ñ–Ω–∫—É:\n   - –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ä—è–¥–æ–∫\n   - –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ\n2. –ó–∞–∫—Ä–∏—Ç–∏ –∫–Ω–∏–≥—É",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–°–∫–ª–∞–¥–µ–Ω–∏–π"],
    correctAnswer: 2,
    explanation: "–¶–ò–ö–õ–Ü–ß–ù–ò–ô - —á–∏—Ç–∞–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è –¥–æ –∫—ñ–Ω—Ü—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –¶–µ —Ü–∏–∫–ª –∑ —É–º–æ–≤–æ—é.",
    algorithmType: 'cyclic',
    icon: "üìñ"
  },
  {
    question: "–Ø–∫–∏–π —Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º?",
    algorithmExample: "1. –ü–û–í–¢–û–†–ò–¢–ò 10 —Ä–∞–∑—ñ–≤:\n   - –ü—Ä–∏—Å—ñ—Å—Ç–∏\n   - –í—Å—Ç–∞—Ç–∏\n2. –í—ñ–¥–ø–æ—á–∏—Ç–∏",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ë–∞–∑–æ–≤–∏–π"],
    correctAnswer: 2,
    explanation: "–¶–ò–ö–õ–Ü–ß–ù–ò–ô - –≤–ø—Ä–∞–≤–∞ –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è –ø–µ–≤–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤. –¶–µ —Ü–∏–∫–ª –∑ –ª—ñ—á–∏–ª—å–Ω–∏–∫–æ–º.",
    algorithmType: 'cyclic',
    icon: "ü§∏"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É:",
    algorithmExample: "1. –ü–û–ö–ò —î –±—Ä—É–¥–Ω–∏–π –ø–æ—Å—É–¥:\n   - –í–∑—è—Ç–∏ —Ç–∞—Ä—ñ–ª–∫—É\n   - –ü–æ–º–∏—Ç–∏ —Ç–∞—Ä—ñ–ª–∫—É\n   - –ü–æ—Å—Ç–∞–≤–∏—Ç–∏ —Å—É—à–∏—Ç–∏—Å—è\n2. –í–∏—Ç–µ—Ä—Ç–∏ —Ä—É–∫–∏",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–π"],
    correctAnswer: 2,
    explanation: "–¶–ò–ö–õ–Ü–ß–ù–ò–ô - –º–∏—Ç—Ç—è –ø–æ—Å—É–¥—É –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è –ø–æ–∫–∏ —î –±—Ä—É–¥–Ω–∏–π –ø–æ—Å—É–¥. –ö–ª–∞—Å–∏—á–Ω–∏–π —Ü–∏–∫–ª –ü–û–ö–ò.",
    algorithmType: 'cyclic',
    icon: "üçΩÔ∏è"
  },
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø?",
    algorithmExample: "1. –ü–û–í–¢–û–†–ò–¢–ò –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —É—á–Ω—è:\n   - –í–∏–∫–ª–∏–∫–∞—Ç–∏ —ñ–º'—è\n   - –í—ñ–¥–º—ñ—Ç–∏—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ—Å—Ç—å\n2. –ü–æ—á–∞—Ç–∏ —É—Ä–æ–∫",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü—Ä—è–º–∏–π"],
    correctAnswer: 2,
    explanation: "–¶–ò–ö–õ–Ü–ß–ù–ò–ô - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —É—á–Ω—è. –¶–µ —Ü–∏–∫–ª –ø–µ—Ä–µ–±–æ—Ä—É.",
    algorithmType: 'cyclic',
    icon: "üìã"
  },

  // More linear examples
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –ù–∞–º–∞–ª—é–≤–∞—Ç–∏ –∫–æ–ª–æ\n2. –ù–∞–º–∞–ª—é–≤–∞—Ç–∏ –æ—á—ñ\n3. –ù–∞–º–∞–ª—é–≤–∞—Ç–∏ –Ω—ñ—Å\n4. –ù–∞–º–∞–ª—é–≤–∞—Ç–∏ —Ä–æ—Ç\n5. –†–æ–∑—Ñ–∞—Ä–±—É–≤–∞—Ç–∏",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–õ–Ü–ù–Ü–ô–ù–ò–ô - –º–∞–ª—é–≤–∞–Ω–Ω—è —Å–º–∞–π–ª–∏–∫–∞ –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º, –±–µ–∑ —É–º–æ–≤ —ñ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å.",
    algorithmType: 'linear',
    icon: "üòä"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø:",
    algorithmExample: "1. –ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—é\n2. –í—ñ–¥–∫—Ä–∏—Ç–∏ —Å–ª–∞–π–¥ ‚Ññ1\n3. –†–æ–∑–ø–æ–≤—ñ—Å—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª\n4. –í—ñ–¥–∫—Ä–∏—Ç–∏ —Å–ª–∞–π–¥ ‚Ññ2\n5. –ó–∞–≤–µ—Ä—à–∏—Ç–∏ –¥–æ–ø–æ–≤—ñ–¥—å",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–°–∫–ª–∞–¥–Ω–∏–π"],
    correctAnswer: 0,
    explanation: "–õ–Ü–ù–Ü–ô–ù–ò–ô - –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—è –π–¥–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ, —Å–ª–∞–π–¥ –∑–∞ —Å–ª–∞–π–¥–æ–º.",
    algorithmType: 'linear',
    icon: "üìä"
  },

  // More branching examples
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—Ü—ñ–Ω–∫—É\n2. –Ø–ö–©–û –æ—Ü—ñ–Ω–∫–∞ >= 7 - –ø–æ—Ö–≤–∞–ª–∏—Ç–∏\n3. –Ü–ù–ê–ö–®–ï - –ø–æ–∑–∞–π–º–∞–π—Å—è —â–µ\n4. –ó–∞–ø–∏—Å–∞—Ç–∏ –≤ —â–æ–¥–µ–Ω–Ω–∏–∫",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ü—Ä—è–º–æ–ª—ñ–Ω—ñ–π–Ω–∏–π"],
    correctAnswer: 1,
    explanation: "–†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô - —Ä–µ–∞–∫—Ü—ñ—è –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –æ—Ü—ñ–Ω–∫–∏. –£–º–æ–≤–Ω–∏–π –≤–∏–±—ñ—Ä –¥—ñ—ó.",
    algorithmType: 'branching',
    icon: "üìù"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø:",
    algorithmExample: "1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ—ó\n2. –Ø–ö–©–û –∑–∞—Ä—è–¥ < 20% - –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∑–∞—Ä—è–¥–∫—É\n3. –Ü–ù–ê–ö–®–ï - –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–ï–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∏–π"],
    correctAnswer: 1,
    explanation: "–†–û–ó–ì–ê–õ–£–ñ–ï–ù–ò–ô - –¥—ñ—è –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ä—ñ–≤–Ω—è –∑–∞—Ä—è–¥—É –±–∞—Ç–∞—Ä–µ—ó.",
    algorithmType: 'branching',
    icon: "üîã"
  },

  // More cyclic examples
  {
    question: "–Ø–∫–∏–π —Ç–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º—É?",
    algorithmExample: "1. –ü–û–ö–ò –≥—Ä–∞ –Ω–µ –∑–∞–∫—ñ–Ω—á–µ–Ω–∞:\n   - –ó—Ä–æ–±–∏—Ç–∏ —Ö—ñ–¥\n   - –ü–æ—á–µ–∫–∞—Ç–∏ —Ö–æ–¥ —Å—É–ø–µ—Ä–Ω–∏–∫–∞\n   - –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç\n2. –û–≥–æ–ª–æ—Å–∏—Ç–∏ –ø–µ—Ä–µ–º–æ–∂—Ü—è",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π"],
    correctAnswer: 2,
    explanation: "–¶–ò–ö–õ–Ü–ß–ù–ò–ô - —Ö–æ–¥–∏ –ø–æ–≤—Ç–æ—Ä—é—é—Ç—å—Å—è –ø–æ–∫–∏ –≥—Ä–∞ –Ω–µ –∑–∞–∫—ñ–Ω—á–∏—Ç—å—Å—è.",
    algorithmType: 'cyclic',
    icon: "üéÆ"
  },
  {
    question: "–í–∏–∑–Ω–∞—á —Ç–∏–ø:",
    algorithmExample: "1. –ü–û–í–¢–û–†–ò–¢–ò 5 —Ä–∞–∑—ñ–≤:\n   - –í–¥–∏—Ö–Ω—É—Ç–∏ –ø–æ–≤—ñ—Ç—Ä—è\n   - –ó–∞—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–¥–∏—Ö –Ω–∞ 3 —Å–µ–∫—É–Ω–¥–∏\n   - –í–∏–¥–∏—Ö–Ω—É—Ç–∏\n2. –í—ñ–¥—á—É—Ç–∏ —Ä–æ–∑—Å–ª–∞–±–ª–µ–Ω–Ω—è",
    options: ["–õ—ñ–Ω—ñ–π–Ω–∏–π", "–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π", "–¶–∏–∫–ª—ñ—á–Ω–∏–π", "–õ—ñ–Ω—ñ–π–Ω–æ-–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–π"],
    correctAnswer: 2,
    explanation: "–¶–ò–ö–õ–Ü–ß–ù–ò–ô - –¥–∏—Ö–∞–ª—å–Ω–∞ –≤–ø—Ä–∞–≤–∞ –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è 5 —Ä–∞–∑—ñ–≤.",
    algorithmType: 'cyclic',
    icon: "üßò"
  }
];

const TYPE_GRADIENTS = {
  linear: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
  branching: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
  cyclic: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)'
};

export default function AlgorithmTypeGame({ onBack, onShowHelp, updateScore }: GameProps) {
  const {
    currentChallenge,
    loadNextChallenge
  } = useChallengeManager<AlgorithmTypeChallenge>({
    challenges: ALGORITHM_TYPE_LIBRARY,
    avoidRepeatLast: 8
  });

  const {
    showFeedback,
    isCorrect,
    score,
    streak,
    tasksCompleted,
    showCelebration,
    handleCorrectAnswer,
    handleIncorrectAnswer,
    resetForNewTask
  } = useGameState(updateScore, {
    basePoints: 100,
    streakMultiplier: 10,
    gameType: 'algorithm-types'
  });

  useEffect(() => {
    loadNextChallenge();
  }, [loadNextChallenge]);

  const handleAnswer = async (_option: string, answerIndex: number) => {
    if (showFeedback || !currentChallenge) return;

    const correct = answerIndex === currentChallenge.correctAnswer;

    if (correct) {
      await handleCorrectAnswer();
    } else {
      handleIncorrectAnswer();
    }
  };

  const handleNext = () => {
    loadNextChallenge();
    resetForNewTask();
  };

  if (!currentChallenge) {
    return <div>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>;
  }

  const gradient = TYPE_GRADIENTS[currentChallenge.algorithmType];

  return (
    <GameLayout
      gameType="algorithm-types"
      onBack={onBack}
      onShowHelp={onShowHelp}
      score={score}
      streak={streak}
      tasksCompleted={tasksCompleted}
      showCelebration={showCelebration}
      gradient={gradient}
    >
      <QuestionDisplay
        question={currentChallenge.question}
        color="#667eea"
      >
        <div style={{
          background: '#f8f9fa',
          borderRadius: '15px',
          padding: '20px',
          margin: '20px 0',
          border: '3px solid #667eea',
          boxShadow: '0 4px 15px rgba(0,0,0,0.1)'
        }}>
          <div style={{
            fontSize: '2em',
            textAlign: 'center',
            marginBottom: '15px'
          }}>
            {currentChallenge.icon}
          </div>
          <pre style={{
            fontSize: '1.1em',
            lineHeight: '1.8',
            margin: 0,
            fontFamily: '"Courier New", monospace',
            color: '#333',
            whiteSpace: 'pre-wrap',
            wordWrap: 'break-word'
          }}>
            {currentChallenge.algorithmExample}
          </pre>
        </div>
      </QuestionDisplay>

      {!showFeedback && (
        <OptionGrid
          options={currentChallenge.options}
          onSelect={handleAnswer}
          gradient={gradient}
          columns={2}
        />
      )}

      {showFeedback && (
        <FeedbackSection
          isCorrect={isCorrect!}
          points={100 + (streak - 1) * 10}
          streak={streak}
          explanation={currentChallenge.explanation}
          onNext={handleNext}
          nextButtonText="‚û°Ô∏è –ù–∞—Å—Ç—É–ø–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è"
        >
          {isCorrect && (
            <div style={{
              marginTop: '15px',
              padding: '15px',
              background: 'linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)',
              borderRadius: '12px',
              border: '2px solid #4caf50'
            }}>
              <div style={{ fontSize: '1em', color: '#2e7d32', lineHeight: '1.6' }}>
                <strong>üí° –ü–∞–º'—è—Ç–∞–π:</strong><br/>
                <strong>–õ—ñ–Ω—ñ–π–Ω–∏–π</strong> = –∫—Ä–æ–∫–∏ –π–¥—É—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É ‚û°Ô∏è<br/>
                <strong>–†–æ–∑–≥–∞–ª—É–∂–µ–Ω–∏–π</strong> = —î –≤–∏–±—ñ—Ä (–Ø–ö–©–û-–Ü–ù–ê–ö–®–ï) üîÄ<br/>
                <strong>–¶–∏–∫–ª—ñ—á–Ω–∏–π</strong> = —â–æ—Å—å –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è (–ü–û–ö–ò/–ü–û–í–¢–û–†–ò–¢–ò) üîÑ
              </div>
            </div>
          )}
        </FeedbackSection>
      )}
    </GameLayout>
  );
}
